<div class="login-form">
  <!-- Login Form -->
  <form *ngIf="!requiresTwoFactor" [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form-container">
    <!-- Username -->
    <mat-form-field appearance="outline" class="form-field full-width">
      <mat-label>Usuario o Email</mat-label>
      <input 
        matInput 
        formControlName="username" 
        placeholder="Ingresa tu usuario"
        autocomplete="username"
      >
      <mat-icon matPrefix>person</mat-icon>
      <mat-error *ngIf="loginForm.get('username')?.hasError('required')">
        El usuario es requerido
      </mat-error>
    </mat-form-field>

    <!-- Password -->
    <mat-form-field appearance="outline" class="form-field full-width">
      <mat-label>Contraseña</mat-label>
      <input 
        matInput 
        [type]="hidePassword ? 'password' : 'text'"
        formControlName="password" 
        placeholder="Ingresa tu contraseña"
        autocomplete="current-password"
      >
      <mat-icon matPrefix>lock</mat-icon>
      <button 
        mat-icon-button 
        matSuffix 
        type="button"
        (click)="hidePassword = !hidePassword"
        [attr.aria-label]="hidePassword ? 'Mostrar contraseña' : 'Ocultar contraseña'"
      >
        <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="loginForm.get('password')?.hasError('required')">
        La contraseña es requerida
      </mat-error>
    </mat-form-field>

    <!-- Remember me & Forgot password -->
    <div class="form-options">
      <mat-checkbox color="primary">Recordarme</mat-checkbox>
      <a routerLink="/auth/forgot-password" class="forgot-password">
        ¿Olvidaste tu contraseña?
      </a>
    </div>

    <!-- Submit button -->
    <button 
      mat-raised-button 
      color="primary" 
      type="submit"
      class="submit-btn full-width"
      [disabled]="loading"
    >
      <span *ngIf="!loading">Iniciar Sesión</span>
      <mat-spinner *ngIf="loading" diameter="20"></mat-spinner>
    </button>
  </form>

  <!-- Two Factor Form -->
  <form *ngIf="requiresTwoFactor" [formGroup]="twoFactorForm" (ngSubmit)="onVerifyTwoFactor()" class="two-factor-form">
    <div class="two-factor-header">
      <mat-icon class="security-icon">lock</mat-icon>
      <h3>Verificación en Dos Pasos</h3>
      <p class="instructions">
        Ingresa el código de 6 dígitos generado por tu aplicación de autenticación
      </p>
    </div>

    <mat-form-field appearance="outline" class="form-field full-width">
      <mat-label>Código de verificación</mat-label>
      <input 
        matInput 
        formControlName="code" 
        placeholder="000000"
        maxlength="6"
        autocomplete="one-time-code"
      >
      <mat-icon matPrefix>security</mat-icon>
      <mat-error *ngIf="twoFactorForm.get('code')?.hasError('required')">
        El código es requerido
      </mat-error>
      <mat-error *ngIf="twoFactorForm.get('code')?.hasError('minlength')">
        El código debe tener 6 dígitos
      </mat-error>
    </mat-form-field>

    <button 
      mat-raised-button 
      color="primary" 
      type="submit"
      class="verify-btn full-width"
      [disabled]="loading"
    >
      <span *ngIf="!loading">Verificar</span>
      <mat-spinner *ngIf="loading" diameter="20"></mat-spinner>
    </button>
  </form>
</div>
